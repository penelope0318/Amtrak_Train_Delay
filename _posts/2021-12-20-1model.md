---
title: "Prediction Model"
date: 2021-12-20
published: true
tags: [machine learning, random forest]
excerpt: "Summary of the method and results"
hv-loader:
  hv-chart-2: ["charts/im_hv.html","400"]
  hv-chart-1: ["charts/hv_table2.html","200"]
toc: true
toc_sticky: true
---
![NJ_Transit_Amtrak](https://raw.githubusercontent.com/penelope0318/Amtrak_Train_Delay/master/assets/images/us_njtransit_nec.jpeg)

In order to inform the passengers and operators of the potential delay before the event, we also developed a prediction model, and this section will go through its features and the overall methodology. To begin, we decided to consider the train delay issue as a **classification problem (perceived delay or not)**, rather than a linear regression of the delay minutes. From the practical perspective, the passengers don't really feel the difference between 10 min late and 11 min late, but we believe they would be concerned if the delay duration is perceptible, which in this project is **greater than 5 minutes** (30% of the dataset).

## 1. Related Features

### 1) All features
<div id="hv-chart-1"></div>

### 2) Correlation matrix 
![corr_matrix](https://raw.githubusercontent.com/penelope0318/Amtrak_Train_Delay/master/assets/images/corr_matrix.png)

## 2. Model

After the feature engineering, we scaled the numeric variables and transformed the categorical variables to one-hot features. The model used 2019/11 and 2019/12 delay data, and randomly divided them into 7:3 as train dataset and test dataset corresponding. The train dataset is used to train the model, and the test dataset is for cross-validation to measure the prediction result comprehensively. After that, we run a `RandomForestClassifier` model. Its accuracy is about **74.9%** which is slightly higher than random guessing all trips will not be delayed for more than 5mins ( because in the original dataset, 30% of the trips were delayed for more than 5min). As for the confusion matrix, it shows that 

![corr_matrix](https://raw.githubusercontent.com/penelope0318/Amtrak_Train_Delay/master/assets/images/confusion.png)



<div id="hv-chart-2"></div>



## 3. Next Step
- News data from Twitter
-   Breakdowns now the top cause for canceled NJ Transit trains.
-   https://www.nj.com/news/2021/07/breakdowns-now-the-top-cause-for-canceled-nj-transit-trains-neglect-and-underfunding-to-blame.html

- time lag 
